# Carousell Liked Items Sorter - Project Summary

## Overview
A Chrome Extension (Manifest V3) for managing liked items on Carousell.sg. Helps users scan, sort, filter, and clean up their liked items list.

## Architecture

### Files
- `manifest.json` - Extension configuration (Manifest V3)
- `popup.html/js/css` - Extension popup UI and main logic
- `content.js` - Content script injected into Carousell pages (handles DOM scraping and interactions)
- `categories.js` - Keyword-based category inference system
- `logic.js` - Filtering utilities (largely unused, most logic is in popup.js)
- `scraperLogic.js` - DOM scraping utilities (largely unused, scraping is done in content.js)

### Communication Flow
1. User clicks button in popup -> `popup.js` sends message via `chrome.tabs.sendMessage`
2. `content.js` receives message, performs DOM operations, responds
3. For async operations (loadMore), content.js sends message back via `chrome.runtime.sendMessage`

## Key Features

### Scanning Items
- Finds cards by `data-testid="listing-card-{id}"` pattern
- Extracts: name (from img alt), price (from `p[title*="$"]`), condition, status, link
- Status detection: checks for "sold" or "reserved" in container text

### Load All
- Recursively clicks "Load more" button with random 1.5-4s delays
- Retries up to 3 times if button not found
- Sends `loadMoreComplete` message when done

### Unlike Functionality
- Clicks the `[data-testid="listing-card-btn-like"]` button to toggle unlike
- Individual and bulk unlike supported
- Bulk unlike staggers requests by 300ms to avoid rate limiting

### Category Inference
- Keyword matching against item names
- Categories: Laptops, Desktops, Tablets, Bikes, Cycling Gear, Watches, Cameras, Gaming, Collectibles, Audio, Other

## DOM Selectors (Carousell-specific)
- Listing cards: `[data-testid^="listing-card-"]` where testid matches `listing-card-\d+`
- Like button: `[data-testid="listing-card-btn-like"]`
- Price: `p[title*="$"]`
- Condition text: `p[style*="color: rgb(197, 197, 198)"]`
- Item link: `a[href*="/p/"]`

## Storage
- Uses `chrome.storage.local` for persistence
- Stores: `likedItems` array, `lastScanTime` timestamp

## Notes
- Uses asynchronous message passing with `return true` in listeners
- Random delays used in Load All to avoid bot detection
- Popup must remain open during Load All operation
